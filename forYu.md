## 后台总体设计思路
- 后台与游戏核心应是隔离的。后台不管是没有上线，或者是在做繁重的数据统计工作，都不应对玩家的游戏体验有丝毫的影响
- 后台不但包括可视化网页，更重要的是包括整个游戏运营数据；游戏核心使用的数据存储方案是基于NoSQL的，应该不能满足后台的需求，后台需要自己存储运营数据

基于以上两条认识，最粗略的后台框架是：
- 后台暴露一个消息队列服务，游戏核心在游戏运行的过程中，会不断的push事件到此队列（事件不但包括操作也包括更新后的玩家数据）
- 后台业务进程通过消耗这个消息队列而更新自己的数据和报表（这个过程可以是非实时、批量的，后台业务可以随时下线以更新）
- 当运营人员使用后台时，向后台业务进程请求数据

以上是解决了主流、高频的需求。还有一些低频的需求需要修改游戏中的数据，比如更新公告，赠送玩家金币，给玩家发邮件等。对于此类需求，游戏后端以HTTP形式提供实时API给后台业务进程调用。

#### 事件格式
游戏push给后台的事件都是json串。必然包含的字段有：
- typ: 事件类型
- etime: 在游戏后端事件发生的时间
- usn: 此事件是与哪个玩家挂钩

大部分事件还会有 detail字段，包含详细信息。

两个简单的例子：
```json
{  "typ":"new_user",  "ctime":1515904931, "usn":100000, "detail":{"ver":1,"isguest":1,"ban_score":0,"ctime":1517038051,"RMB":0,"ban_gold":10000,"usn":100000,"gold":0,"nick":"default user","ban_diamond":10,"diamond":0,"score":0,"credit":0,"vip_level":1} }
{  "typ":"login",  "ctime":1515905031, "usn":100000 }
```